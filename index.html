<!DOCTYPE html>
<html>
<head>
  <title>아파트 랭킹 - 우리 아파트 입지는 몇 등일까?</title>
  <meta property="og:type" content="website"> 
  <meta property="og:title" content="AI가 선정한 대한민국 아파트 입지 랭킹">
  <meta property="og:description" content="AI가 선정하는 대한민국 아파트 입지 랭킹">
  <meta property="og:image" content="https://anitooni.github.io/APT-Rank/thumbnail.jpg">
  <meta property="og:url" content="https://anitooni.github.io/APT-Rank/">

  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="shortcut icon" href="https://anitooni.github.io/APT-Rank/apr-rank.png"/>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>  
</head>
<style>
  body{
    -ms-overflow-style: none;
  }
  ::-webkit-scrollbar { display: none; }

  #titleBar{
    position: fixed;
    display: grid;
    grid-template-columns: 80px 1fr 80px;
    top: 0;
    left: 0;
    right: 0;
    width: 100%;
    height: 51px;    
    text-align: center;
    line-height: 50px;
    background-color: #ff3d38;
  }
  #title{
    font-family: Roboto;
    color: white;
    font-size: 1.25em;
    font-weight: 600;
  }  
  #dataList{
    display:block;
    width: 100%;
    padding-top: 96px;    
  }

  .listBox{
    display: grid;
    grid-template-columns: 60px 1fr 80px;
    align-items: center;
    border-bottom: 1px solid gray;
    padding-top: 0.5em;
    padding-bottom: 0.5em;
  }
  .listBox:hover{
    background-color: #ffdfde;
  }

  .listBox:active{
    background-color: #ffbcba;
  }
  .value_score{
    text-align: right;
    justify-content: center;
    padding-right: 8px;
    font-size: 0.9em;
    font-weight: 600;
  }
  .rank{
    text-align: center;
    font-size: 0.85em;
  }
  .apt_address{
    font-size: 0.7em;
    color: gray;
  }
  .apt_name{
    font-size: 0.85em;
    font-weight: bold;
  }

  #selections{        
    display: grid;    
    grid-template-columns: 1.7fr 1fr;
    align-content: center;
    justify-content: center;
    padding-top: 10px;
    padding-bottom: 10px;    
    background-color: #ff3d38;
    position: fixed;
    top: 50px;
    left: 0;
    right: 0;    
  }
  #region, #month{
    width: 90%;
    height: 2em;
    font-size: 0.8em;
    margin-right: 2px;
    border: none;
    background-color: white;
  }  
  #region_selection, #month_selection{
    text-align: center;
  }

  .modal-body{
    padding-left: 10px;
    padding-right: 10px;
    padding-top: 10px;    
  }
  .popRank{
    text-align: center;
    font-size: 1.5em;
    font-weight: 600;    
  }
  .popupTitle{    
    font-weight: 900;    
  }
  .popupSubtitle{
    font-size: 0.7em;
    color: gray;
  }
  .popSubTable{
    display: grid;
    height: 1.8em;
    grid-template-columns: 1.5fr 1fr;    
    margin-top: 10px;
    margin-bottom: 10px;
    border-bottom: solid 1px rgb(216, 216, 216);
  }
  #popSubStation{
    display: grid;    
    grid-template-columns: 1fr 2fr;
  }
  #popSubLiving{
    display: block;
    padding-bottom: 10px;
    border-bottom: solid 1px rgb(216, 216, 216);    
  }
  #popSubResult{
    text-align: left;
  }
  #popLiving{
    display: block;    
  }
  .popTitle{
    font-weight: 600;
  }
  .popContent{
    font-size: 0.9em;
    text-align: left;
  }
  .popTable{
    display:grid;
  }
  .popResult{    
    font-size: 0.9em;
    font-weight: 600;
    text-align: right;
  }
  .card{
    margin-bottom: 10px;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 1px 3px, rgba(0, 0, 0, 0.24) 0px 1px 2px;
  }

  #help{
    font-size: 1.5em;
    color: white;
    text-align: right;
    padding-right: 20px;
  }
  .notice{
    font-size: 0.85em;    
    padding-left: 10px;
    padding-right: 10px;
    margin-bottom: 10px;
    word-wrap: break-word;
    word-break: keep-all;
  }

  @media screen and (min-width: 800px){
    #modal .modalWindow{      
      width: 700px;
    }
    #close{
      width: 700px;
    }
    #centerBox{
      width: 100%;
      display: grid;
      grid-template-columns: 800px;
      justify-content:center;
    }
    #titleBar{
      margin: 0 auto;
      width: 800px;
    }
    #selections{
      margin: 0 auto;
      width: 800px;
    }    
  }  
</style>

<body>
  <div id="container">
    <div id="centerBox">
      <div id="titleBar">
        <div id='logo'></div>
        <div id="title">아파트 랭킹</div>
        <div id='help' data-bs-toggle='modal' data-bs-target='#exampleModal' id='myModal' onClick='showNotice()'><i class="fas fa-question-circle"></i></div>
      </div>      

      <div id="selections">
        <div id="region_selection">          
          <select id="region" onChange="updateRegion()">
            <optgroup value="Seoul" label="서울시">
                <option value="1168000000_Seoul_Gangnam">서울시 강남구</option>
                <option value="1165000000_Seoul_Seocho">서울시 서초구</option>
                <option value="1171000000_Seoul_Songpa">서울시 송파구</option>
            </optgroup>
            <optgroup value="Gyeonggi" label="경기도">
                <option value="4111300000_Gyeonggi_Suwon_Gwonseon">경기도 수원시 권선구</option>
                <option value="4111700000_Gyeonggi_Suwon_Yeongtong">경기도 수원시 영통구</option>                
                <option value="4111100000_Gyeonggi_Suwon_Jangan">경기도 수원시 장안구</option>
                <option value="4111500000_Gyeonggi_Suwon_Paldal">경기도 수원시 팔달구</option>

                <option value="4146500000_Gyeonggi_Yongin_Suji">경기도 용인시 수지구</option>
                <option value="4146300000_Gyeonggi_Yongin_Giheung">경기도 용인시 기흥구</option>
                <option value="4146100000_Gyeonggi_Yongin_Cheoin">경기도 용인시 처인구</option>
            </optgroup>
            <optgroup value="Busan" label="부산시">
              <option value="2644000000_Busan_Gangseo">부산시 강서구</option>
              <option value="2641000000_Busan_Geumjeong">부산시 금정구</option>                
              <option value="2671000000_Busan_Gijangn">부산시 기장군</option>
              <option value="2629000000_Busan_Nam">부산시 남구</option>
              <option value="2617000000_Busan_Dong">부산시 동구</option>
              <option value="2626000000_Busan_Dongnae">부산시 동래구</option>                
              <option value="2623000000_Busan_Busanjin">부산시 부산진구</option>
              <option value="2632000000_Busan_Buk">부산시 북구</option>
              <option value="2653000000_Busan_Sasang">부산시 사상구</option>
              <option value="2638000000_Busan_Saha">부산시 사하구</option>                
              <option value="2614000000_Busan_Seo">부산시 서구</option>
              <option value="2650000000_Busan_Suyeong">부산시 수영구</option>
              <option value="2647000000_Busan_Yeonje">부산시 연제구</option>
              <option value="2620000000_Busan_Yeongdo">부산시 영도구</option>                
              <option value="2611000000_Busan_Jung">부산시 중구</option>
              <option value="2635000000_Busan_Haeundae">부산시 해운대구</option>              
          </optgroup>
          <optgroup value="Daegu" label="대구시">
            <option value="2711000000_Daegu_Jung">대구시 중구</option>
            <option value="2714000000_Daegu_Dong">대구시 동구</option>                
            <option value="2717000000_Daegu_Seo">대구시 서구</option>
            <option value="2720000000_Daegu_Nam">대구시 남구</option>
            <option value="2723000000_Daegu_Buk">대구시 북구</option>
            <option value="2726000000_Daegu_Suseong">대구시 수성구</option>                
            <option value="2729000000_Daegu_Dalseo">대구시 달서구</option>
            <option value="2771000000_Daegu_Dalseong">대구시 달성군</option>
        </optgroup>
          </select>
        </div>
        <div id="month_selection">
          <select id="month" onChange="updateMonth()">            
            <option value="202201">2022년 01월</option>            
          </select>          
        </div>
      </div>

      <div id="dataList">        
        <script>
          var itemNum = 0;
          var aptData = "";
          var prevValue = 0;          

          $(document).ready(function(){
            $.getJSON("https://anitooni.github.io/APT-Rank/202201/1168000000_Seoul_Gangnam.json", function(json) {
              //console.log(json);
              aptData = json;
              itemNum = json.data.length;              

              for(var i = 0 ; i < itemNum ; i++){                
                var aptName = aptData.data[i]["아파트명"]
                var apt_m = aptData.data[i]["전용면적(m2)"]
                var apt_p = aptData.data[i]["전용면적(평)"]
                var aptAddress = aptData.data[i]["법정동주소"]
                var aptValue = Math.round( aptData.data[i]["가치 총점"] * 100 ) / 100;
                var rank = aptData.data[i]["rank"].toFixed()

                valueSum += aptData.data[i]["가치 총점"]
                livingSum += aptData.data[i]["주거총점"]
                transportSum += aptData.data[i]["교통총점"]
                infraSum += aptData.data[i]["인프라총점"]
                eduSum += aptData.data[i]["학군총점"]
                
                //var addon_html = "<div class='listBox' onClick='showDetail(" + i + ")'>";
                var addon_html = "<div class='listBox' data-bs-toggle='modal' data-bs-target='#exampleModal' id='myModal' onClick='showDetail(" + i + ")'>";
                addon_html += "<div class='rank'>" + rank + "위</div>";
                addon_html += "<div class='content'>";
                //addon_html += "<div class='apt_name'>" + aptName + " " + apt_p + "(" + apt_m + ")</div>";
                addon_html += "<div class='apt_name'>" + aptName + "</div>";
                addon_html += "<div class='apt_address'>" + aptAddress + "</div>";
                addon_html += "</div>";
                addon_html += "<div class='value_score'>" + aptValue + "점</div>"
                addon_html += "</div>"

                $('#dataList').append(addon_html);
              } 
            });

            $('div.modal').on('show.bs.modal', function() {
              var modal = this;
              var hash = modal.id;
              window.location.hash = hash;
              window.onhashchange = function() {
                if (!location.hash){
                  $(modal).modal('hide');
                }
              }
            });
            $('div.modal').on('hidden.bs.modal', function() {
              var hash = this.id;
              history.replaceState('', document.title, window.location.pathname);
            })
          });          
        </script>
      </div>
    </div>
  </div>

  <!-- Vertically centered scrollable modal -->
  <!-- Button trigger modal -->
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id='aptDetail'></div>        
      </div>
    </div>
  </div>  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
</body>

<script>
  var selectedMonth = document.getElementById("month").value
  var selectedRegion = document.getElementById("region").value
  var regionName = $("#region option:selected").text()
  var valueSum = 0;
  var livingSum = 0;
  var transportSum = 0;
  var infraSum = 0;
  var eduSum = 0;  

  function updateMonth(){
    var selection = document.getElementById("month")
    selectedMonth = selection.value
    updateTable(selectedMonth, selectedRegion)
    regionName = $("#region option:selected").text()
  }
  function updateRegion(){
    var selection = document.getElementById("region")
    selectedRegion = selection.value
    updateTable(selectedMonth, selectedRegion)
    regionName = $("#region option:selected").text()
    //console.log(selectedRegion);
  }

  function updateTable(month, region){
    $('html').scrollTop(0)
    url = "https://anitooni.github.io/APT-Rank/" + month + "/" + region + ".json"
    //console.log(url)
    $('#dataList').html("");

    $.getJSON(url, function(json) {
        //console.log(json);
        aptData = json;
        itemNum = json.data.length;
        valueSum = 0;
        livingSum = 0;
        transportSum = 0;
        infraSum = 0;
        eduSum = 0;

        for(var i = 0 ; i < itemNum ; i++){                
          var aptName = aptData.data[i]["아파트명"]
          var apt_m = aptData.data[i]["전용면적(m2)"]
          var apt_p = aptData.data[i]["전용면적(평)"]
          var aptAddress = aptData.data[i]["법정동주소"]
          var aptValue = Math.round( aptData.data[i]["가치 총점"] * 100 ) / 100;
          var rank = aptData.data[i]["rank"].toFixed()

          valueSum += aptData.data[i]["가치 총점"]
          livingSum += aptData.data[i]["주거총점"]
          transportSum += aptData.data[i]["교통총점"]
          infraSum += aptData.data[i]["인프라총점"]
          eduSum += aptData.data[i]["학군총점"]

          //console.log(valueSum)

          var addon_html = "<div class='listBox' data-bs-toggle='modal' data-bs-target='#exampleModal' id='myModal' onClick='showDetail(" + i + ")'>";
          addon_html += "<div class='rank'>" + rank + "위</div>";
          addon_html += "<div class='content'>";
          //addon_html += "<div class='apt_name'>" + aptName + " " + apt_p + "(" + apt_m + ")</div>";
          addon_html += "<div class='apt_name'>" + aptName + "</div>";
          addon_html += "<div class='apt_address'>" + aptAddress + "</div>";
          addon_html += "</div>";
          addon_html += "<div class='value_score'>" + aptValue + "점</div>"
          addon_html += "</div>"

          $('#dataList').append(addon_html);
        }
    })
  }

  function showDetail(index){
    titleHtml = "";
    detailHtml = "";    
    var aptRank = aptData.data[index]["rank"] + "/" + aptData.data[itemNum-1]["rank"] + "위"
    var aptName = aptData.data[index]["아파트명"]
    var apt_m = aptData.data[index]["전용면적(m2)"]
    var apt_p = aptData.data[index]["전용면적(평)"]
    var aptAddress = aptData.data[index]["법정동주소"]
    var aptValue = Math.round( aptData.data[index]["가치 총점"] * 100 ) / 100;
    var aptYear = aptData.data[index]["준공년월"] + " (" + aptData.data[index]["준공년차"] + "년차)"
    var nearestStation = aptData.data[index]["가까운역이름"] + "역" + "(" + aptData.data[index]["가까운역거리"] + "m)"
    var stationArea = aptData.data[index]["역세권여부"]
    var stationPoint_30m = aptData.data[index]["30분이내주요거점역"] + "개"
    var stationPoint_1h = aptData.data[index]["1시간이내주요거점역"] + "개"
    var departmentStore_3km = aptData.data[index]["3km이내백화점수"] + "개"
    var OutletMall_5km = aptData.data[index]["5km이내아울렛몰수"] + "개"
    var bigMart_1km = aptData.data[index]["1km이내대형먀트수"] + "개"
    var bank_500m = aptData.data[index]["500m이내은행수"] + "개"
    var hospital_500m = aptData.data[index]["500m이내병원수"] + "개"
    var bigHospital_5km = aptData.data[index]["5km이내대형병원수"] + "개"
    var park_500m = aptData.data[index]["500m이내공원수"] + "개"
    var harmful_3km = aptData.data[index]["3km이내혐오시설수"] + "개"
    var pSchool_edu = aptData.data[index]["초등학교학업성취도"] + "%"
    var mSchool_edu = aptData.data[index]["중학교학업성취도"] + "%"
    var livingScore = aptData.data[index]["주거총점"] + "점"
    var transportScore = aptData.data[index]["교통총점"]
    var infraScore = aptData.data[index]["인프라총점"]
    var eduScore = aptData.data[index]["학군총점"]
    var livingScore = aptData.data[index]["주거총점"]
    var area_info = aptData.data[index]["area_info"]
    var house_num = aptData.data[index]["세대수"]
    var populationScore = Math.round( aptData.data[index]["인구총점"] * 100 ) / 100
    var jobScore = Math.round( aptData.data[index]["일자리총점"] * 100 ) / 100

    //Title    
    //titleHtml += "<div class='popupTitle'>" + aptName + " " + apt_p + "(" + apt_m + ")</div>";    
    titleHtml += "<div class='popupTitle'>" + aptName + "</div>";    
    titleHtml += "<div class='popupSubtitle'>" + aptYear + "</div>";
    titleHtml += "<div class='popupSubtitle'>" + aptAddress + "</div>";    

    //총점,순위
    detailHtml += "<div class='card'>";
    detailHtml += "<div class='card-header'>";
    detailHtml += "<div class='popRank'><i class='fas fa-trophy'></i> " + aptRank + "</div>";
    detailHtml += "</div>";
    detailHtml += "<div class='card-body'>";    
    detailHtml += "<div class='graph' style='height: 200px'> <canvas id='valueChart'></canvas></div>"
    detailHtml += "</div></div>"

    //주거
    detailHtml += "<div class='card'>";
    detailHtml += "<div class='card-header'>";
    detailHtml += "<div class='popTitle'><i class='fas fa-home'></i>&nbsp&nbsp주거</div>"
    detailHtml += "</div>";
    detailHtml += "<div class='card-body'>";
    detailHtml += "<div id='popLiving'>"
    detailHtml += "<div class='graph' style='height: 120px'> <canvas id='livingChart'></canvas></div>"
    detailHtml += "<div class='popTable'>"
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "세대수" + "</div>" + "<div class='popResult'>" + house_num + "세대</div></div>";
    detailHtml += "<div id='popSubLiving'><div class='popContent'>" + "면적 구성" + "<br>" + "<span class='popResult'>" + area_info + "</span></div></div>";
    detailHtml += "</div></div></div></div>"   
    avgLivingScore = Math.round( livingSum/itemNum * 100 ) / 100

    if(transportScore != "NA"){
      //교통
      detailHtml += "<div class='card'>";
      detailHtml += "<div class='card-header'>";
      detailHtml += "<div class='popTitle'><i class='fas fa-bus'></i>&nbsp&nbsp교통</div>"
      detailHtml += "</div>";
      detailHtml += "<div class='card-body'>";
      detailHtml += "<div id='popTransport'>"
      detailHtml += "<div class='graph' style='height: 120px'> <canvas id='transportChart'></canvas></div>"
      detailHtml += "<div class='popTable'>"
      detailHtml += "<div class='popSubTable' id='popSubStation'><div class='popContent'>" + "가장 가까운 역" + "</div>" + "<div class='popResult'>" + nearestStation + "</div></div>";
      detailHtml += "<div class='popSubTable'><div class='popContent'>" + "30분 이내 도착 가능 주요역" + "</div>" + "<div class='popResult'>" + stationPoint_30m + "</div></div>";
      detailHtml += "<div class='popSubTable'><div class='popContent'>" + "1시간 이내 도착 가능 주요역" + "</div>" + "<div class='popResult'>" + stationPoint_1h + "</div></div>";    
      detailHtml += "</div></div></div></div>"
      avgTransportScore = Math.round( transportSum/itemNum * 100 ) / 100
    }

    //인프라
    detailHtml += "<div class='card'>";
    detailHtml += "<div class='card-header'>";
    detailHtml += "<div class='popTitle'><i class='fas fa-hospital-user'></i>&nbsp&nbsp인프라</div>"
    detailHtml += "</div>";
    detailHtml += "<div class='card-body'>";
    detailHtml += "<div id='popInfra'>"    
    detailHtml += "<div class='graph' style='height: 120px'> <canvas id='infraChart'></canvas></div>"
    detailHtml += "<div class='popTable'>"
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "3km 이내 백화점" + "</div>" + "<div class='popResult'>" + departmentStore_3km + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "5km 이내 아울렛/몰" + "</div>" + "<div class='popResult'>" + OutletMall_5km + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "1km 이내 대형마트" + "</div>" + "<div class='popResult'>" + bigMart_1km + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "500m 이내 은행" + "</div>" + "<div class='popResult'>" + bank_500m + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "500m 이내 병원" + "</div>" + "<div class='popResult'>" + bank_500m + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "5km 이내 대형병원" + "</div>" + "<div class='popResult'>" + bigHospital_5km + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "500m 이내 공원" + "</div>" + "<div class='popResult'>" + park_500m + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "3km 이내 혐오시설" + "</div>" + "<div class='popResult'>" + harmful_3km + "</div></div>";
    detailHtml += "</div></div></div></div>"
    avgInfraScore = Math.round( infraSum/itemNum * 100 ) / 100;

    //학군
    detailHtml += "<div class='card'>";
    detailHtml += "<div class='card-header'>";
    detailHtml += "<div class='popTitle'><i class='fas fa-graduation-cap'></i>&nbsp&nbsp학군</div>"
    detailHtml += "</div>";
    detailHtml += "<div class='card-body'>";
    detailHtml += "<div id='popEducation'>"    
    detailHtml += "<div class='graph' style='height: 120px'> <canvas id='eduChart'></canvas></div>"
    detailHtml += "<div class='popTable'>"
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "초등학교 학업성취도" + "</div>" + "<div class='popResult'>" + pSchool_edu + "</div></div>";
    detailHtml += "<div class='popSubTable'><div class='popContent'>" + "중학교 학업성취도" + "</div>" + "<div class='popResult'>" + mSchool_edu + "</div></div>";    
    detailHtml += "</div></div></div></div>"
    avgEduScore = Math.round( eduSum/itemNum * 100 ) / 100;    
    
    //지역구    
    detailHtml += "<div class='card'>";
    detailHtml += "<div class='card-header'>";
    detailHtml += "<div class='popTitle'><i class='fas fa-layer-group'></i>&nbsp&nbsp" + regionName + "</div>"
    detailHtml += "</div>";
    detailHtml += "<div class='card-body'>";
    detailHtml += "<div id='popEducation'>"    
    detailHtml += "<div class='graph' style='height: 120px'> <canvas id='regionChart'></canvas></div>"        
    detailHtml += "</div></div></div>"

    $('#aptDetail').html(detailHtml);
    $('#exampleModalLabel').html(titleHtml);
    drawChart(aptValue, livingScore, transportScore, infraScore, eduScore)
    drawSubChart(livingScore, avgLivingScore, "주거총점", "지역평균", "#ff3d38", "#9f9f9f",  "livingChart")
    if(transportScore != "NA"){
      drawSubChart(transportScore, avgTransportScore, "교통총점", "지역평균", "#ff3d38", "#9f9f9f", "transportChart")
    }
    drawSubChart(infraScore, avgInfraScore, "인프라총점", "지역평균", "#ff3d38", "#9f9f9f", "infraChart")
    drawSubChart(eduScore, avgEduScore, "학군총점", "지역평균", "#ff3d38", "#9f9f9f", "eduChart")
    drawSubChart(eduScore, avgEduScore, "인구총점", "일자리총점", "#ff3d38", "#ff3d38", "regionChart")
  }

  function drawChart(aptValue, livingScore, transportScore, infraScore, eduScore){
      var label = ["총점", "주거", "교통", "인프라", "교육"]
      var data = [aptValue, livingScore, transportScore, infraScore, eduScore]

      if(transportScore == "NA"){
        label = ["총점", "주거", "인프라", "교육"]
        data = [aptValue, livingScore, infraScore, eduScore]
      }      

      var ctx = document.getElementById("valueChart").getContext('2d');
      var myChart = new Chart(ctx, {
        type: 'bar',
        plugins:[ChartDataLabels],
        data: {          
          labels: label,
          datasets: [{                
            data: data,
            backgroundColor: [
                '#ff3d38',
                '#f97f95',
                '#f97f95',
                '#f97f95',
                '#f97f95',
            ],
            borderColor: [
                'rgba(255,99,132, 0)',
                'rgba(54, 162, 235, 0)',
            ],                
            barThickness: 17,            
          }]
        },
        options: {
          indexAxis: 'y',
          maintainAspectRatio: false,          
          plugins:{
            legend:{
              display: false
            },            
            datalabels: {
              display: true,
              color: 'white',
              align: 'start',
              anchor: 'end',              
              offset: 6,
              textAlign: 'center',
              font: {
                weight: 'bold'
              },              
            },                      
          },
          animation: {            
            x:{
              from: 100
            }
          },
          scales: {
            x:{
              type: 'linear',
              min: 0,
              max: 100,
            },
            myScale: {              
              position: 'left', // `axis` is determined by the position as `'y'`
            }
          }          
        }
    });
  }

  function showNotice(){
    var titleHtml = "<div class='popupTitle'> 아파트 랭킹에서 알려드립니다 </div>";
    var detailHtml = "<div class='notice'> 안녕하세요. 아파트랭킹입니다.</div>";
    detailHtml += "<div class='notice'> 종합적인 아파트 정보를 제공하는 서비스가 많음에도 불구하고, 우리 지역의 진짜 입지 좋은 곳을 한 번에 판단하기가 너무 어려워 아파트 랭킹 서비스를 만들었습니다. </div>";
    detailHtml += "<div class='notice'> 개개인이 생각하는 아파트의 중요한 요소들이 있겠지만, AI를 통해 많은 정보를 종합하여 선정된 순서를 보여드리고자 했으니 유용하게 사용하시기 바래봅니다! </div>";
    detailHtml += "<div class='notice'> 지속적인 업데이트를 통해 더 좋은 서비스를 제공하도록 노력하겠습니다. </div>";
    detailHtml += "<div class='notice'> 서비스 사용에 대한 중요한 공지사항을 꼭 확인해 주세요!</div>";
    detailHtml += "<hr>";
    detailHtml += "<ul>";
    detailHtml += "<li><div class='notice'> 아파트 랭킹의 점수는 투자지표가 아님을 말씀드립니다. 투자 판단에 대한 모든 책임은 투자자 본인에게 있습니다.</div></li>";
    detailHtml += "<li><div class='notice'> 모든 점수는 환경 요소를 분석한 AI가 선정하며, 일체의 임의적 조작을 가하지 않습니다.</div></li>";
    detailHtml += "<li><div class='notice'> 점수는 해당 지역구의 상대 점수이며, 다른 지역구의 동일 점수와 같은 가치를 나타내지 않습니다.</div></li>";
    detailHtml += "<li><div class='notice'> 단지의 정보는 네이버 부동산 정보를 참조합니다.</div></li>";
    detailHtml += "<li><div class='notice'> 수도권 교통 정보는 지하철역 위치 정보를 기반으로 산정됩니다.</div></li>";
    detailHtml += "<li><div class='notice'> 인프라 정보는 각 백화점/마트 홈페이지, 은행연합회, 자원순환정보시스템, 공공데이터 포탈의 정보를 기반으로 산정됩니다.</div></li>";
    detailHtml += "<li><div class='notice'> 학군 정보는 교육통계서비스 정보를 기반으로 산정됩니다.</div></li>";
    detailHtml += "<li><div class='notice'> 지역구 정보는 공공데이터포탈 정보를 기반으로 산정됩니다.</div></li>";
    detailHtml += "<li><div class='notice'> 모든 정보는 월 1회 업데이트 예정이며, 각 기반 정보의 업데이트 시점에 따라 변동 가능성이 있습니다.</div></li>";
    detailHtml += "<li><div class='notice'> 문의사항, 오류수정, 개선제안은 이메일을 통해 요청해 주세요.</div></li>";
    detailHtml += "<li><div class='notice'> <a href='mailto:anitooni@gmail.com'>anitooni@gmail.com</a></div></li>";
    detailHtml += "</ul>";
    
    $('#exampleModalLabel').html(titleHtml);
    $('#aptDetail').html(detailHtml);
  }
  
  function drawSubChart(score, avgScore, label1, label2, color1, color2, className){    
      var ctx = document.getElementById(className).getContext('2d');
      var myChart = new Chart(ctx, {
        type: 'bar',
        plugins:[ChartDataLabels],
        data: {          
          labels: [label1, label2],
          datasets: [{                
            data: [score, avgScore],
            backgroundColor: [
                color1,
                color2,
            ],               
            barThickness: 20,            
          }]
        },
        options: {
          indexAxis: 'y',
          maintainAspectRatio: false,          
          plugins:{
            legend:{
              display: false
            },            
            datalabels: {
              display: true,
              color: 'white',
              align: 'start',
              anchor: 'end',              
              offset: 6,
              textAlign: 'center',
              font: {
                weight: 'bold'
              },              
            },                      
          },
          animation: {            
            x:{
              from: 100
            }
          },
          scales: {
            x:{
              type: 'linear',
              min: 0,
              max: 100,
            },
            myScale: {              
              position: 'left', // `axis` is determined by the position as `'y'`
            }
          }          
        }
    });
  }
</script>
</html>